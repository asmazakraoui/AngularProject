<div class="container-scroller">
    <app-nav-back></app-nav-back>
    <div class="container-fluid page-body-wrapper">
        <app-sidebar></app-sidebar>
        <div class="main-panel">
            <!-- Contenu principal -->
            <div class="col-md-12 mt-5">
                <div class="container">
                    <h2 style="padding-bottom: 20px;">Orders List</h2>
                    <div class="row">
                        <div class="col-md-4 mb-4" *ngFor="let order of getCurrentPageOrders()" >
                            <div class="custom-card" (click)="loadCommandLines(order.idCom)">
                                <div class="card-body">
                                    <p class="card-text">Order Date: {{ order.dateCommande | date:'medium' }}</p>
                                    <p class="card-text">Total Price: {{ order.totalPrix }} TND</p>
                                    <p class="card-text">Discount: {{ order.remise }} TND</p>
                                    <button class="btn btn-primary" (click)="openModal(order)">Details Order</button>
                                </div>
                            </div>
                        </div>
                        <!-- Affichage des cartes de produit filtrÃ©es -->
                        <div class="col-lg-12">
                            <div class="mini-card">
                            <!-- Boutons de tri -->
                            <div class="sort-buttons">
                                <div class="sort-label">Tri By Price</div>
                                <ul class="wrapper">
                                    <li class="icon black" (click)="getOrdersSortedByDateAsc()">
                                        <span class="tooltip">Asc</span>
                                        <span><svg viewBox="0 0 16 16" class="bi bi-chevron-double-up" fill="currentColor" height="15" width="15" xmlns="http://www.w3.org/2000/svg">
                                <path d="M7.646 2.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 3.707 2.354 9.354a.5.5 0 1 1-.708-.708l6-6z" fill-rule="evenodd"></path>
                                <path d="M7.646 6.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 7.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z" fill-rule="evenodd"></path>
                            </svg></span>
                                    </li>
                                    <li class="icon black" (click)="getOrdersSortedByDateDesc()">
                                        <span class="tooltip">Desc</span>
                                        <span><svg viewBox="0 0 16 16" class="bi bi-chevron-double-down" fill="currentColor" height="15" width="15" xmlns="http://www.w3.org/2000/svg">
                                <path d="M1.646 6.646a.5.5 0 0 1 .708 0L8 12.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z" fill-rule="evenodd"></path>
                                <path d="M1.646 2.646a.5.5 0 0 1 .708 0L8 8.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z" fill-rule="evenodd"></path>
                            </svg></span>
                                    </li>
                                </ul>
                            </div>

                            <!-- Pagination -->
                            <div class="pagination-container d-flex justify-content-center mt-4 ">
                                <ul class="pagination">
                                    <li class="page-item" [class.disabled]="currentPage == 1" (click)="onPageChange(currentPage - 1)">
                                        <a class="page-link" aria-label="Previous">
                                            <span aria-hidden="true">&laquo;</span>
                                        </a>
                                    </li>
                                    <li class="page-item" *ngFor="let page of pages" [class.active]="page === currentPage">
                                        <a class="page-link" (click)="onPageChange(page)">{{ page }}</a>
                                    </li>
                                    <li class="page-item" [class.disabled]="currentPage == totalPages" (click)="onPageChange(currentPage + 1)">
                                        <a class="page-link" aria-label="Next">
                                            <span aria-hidden="true">&raquo;</span>
                                        </a>
                                    </li>
                                </ul> 
                            </div>
                        </div>


                    </div>    
                </div>
            </div>
        </div>    
    </div>
</div>


<div class="custom-modal" tabindex="-1" role="dialog" *ngIf="etat">
    <div class="custom-modal-dialog" role="document">
      <div class="custom-modal-content">
        <div class="custom-modal-header">
          <h5 class="custom-modal-title">Order Details</h5>
          <button type="button" class="close" aria-label="Close" (click)="closeModal()">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
  
        <div class="custom-modal-body">
            <table class="table">
              <thead>
                <tr>
                    <div>
                        <th>Product Image</th>
                        <th>Product Name</th>
                        <th>Unit Price</th>
                        <th>Quantity</th>
                        <th>Discount</th>
                    </div>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let commandLine of commandLines" >
                    <div (click)="getProductDetails(commandLine.idLigneCom)">
                        <td >
                        <img [src]="getImageUrl(product.imageProduit)" class="img-fluid" alt="Product Image">
                        </td>
                        <td>{{product.nomProduit }}</td>
                        <td>{{product.prixProduit }} TND</td>
                        <td>{{ commandLine.quantite }}</td>
                        <td>{{ commandLine.prix_total_product }} TND</td>
                    </div>  
                  </tr>
              </tbody>
            </table>
          </div>
  
      </div>
    </div>
  </div>
  